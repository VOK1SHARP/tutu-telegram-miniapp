<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ТИ•ТИ - Чайная лавка</title>
    <meta name="description" content="Онлайн-заказ китайского чая в Telegram Mini App">
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">
    
    <!-- Open Graph для красивого отображения в Telegram -->
    <meta property="og:title" content="ТИ•ТИ - Чайная лавка">
    <meta property="og:description" content="Заказывайте аутентичный китайский чай прямо в Telegram!">
    <meta property="og:image" content="https://ваш-сайт.netlify.app/images/og-image.jpg">
    <meta property="og:url" content="https://ваш-сайт.netlify.app">
    
    <!-- Скрипт для проверки Telegram WebApp -->
    <script>
        // Проверяем, запущено ли в Telegram
        function isTelegramWebApp() {
            return window.Telegram && window.Telegram.WebApp;
        }
        
        // Функция для отладки
        function debugTelegram() {
            if (isTelegramWebApp()) {
                console.log('Telegram WebApp доступен');
                console.log('Версия:', Telegram.WebApp.version);
                console.log('Платформа:', Telegram.WebApp.platform);
                console.log('Инициализация:', Telegram.WebApp.initData);
                console.log('Пользователь:', Telegram.WebApp.initDataUnsafe?.user);
            } else {
                console.log('Telegram WebApp НЕ доступен');
            }
        }
        
        // Вызываем отладку при загрузке
        window.addEventListener('load', debugTelegram);
    </script>
</head>
<body>
    <!-- Индикатор синхронизации -->
    <div id="sync-indicator" class="sync-indicator" style="display: none;">
        <i class="fas fa-sync-alt fa-spin"></i> Синхронизация...
    </div>
    
    <div id="app">
        <!-- Контент загружается через JavaScript -->
    </div>
    
    <!-- Загрузочный экран -->
    <div id="loader">
        <div class="loader-content">
            <div class="loader-spinner">
                <i class="fas fa-leaf fa-spin"></i>
            </div>
            <h2>ТИ•ТИ</h2>
            <p id="loader-text">Загружаем чайную лавку...</p>
            <p id="loader-status" style="font-size: 12px; opacity: 0.7; margin-top: 10px;"></p>
        </div>
    </div>

    <script src="app.js"></script>
    
    <script>
        // Дополнительная проверка для Telegram
        document.addEventListener('DOMContentLoaded', function() {
            const loaderText = document.getElementById('loader-text');
            const loaderStatus = document.getElementById('loader-status');
            
            if (isTelegramWebApp()) {
                loaderStatus.textContent = 'Определяем пользователя Telegram...';
                
                // Небольшая задержка для инициализации Telegram WebApp
                setTimeout(() => {
                    const tg = window.Telegram.WebApp;
                    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                        loaderStatus.textContent = `Привет, ${tg.initDataUnsafe.user.first_name || 'пользователь'}!`;
                    } else {
                        loaderStatus.textContent = 'Telegram WebApp загружен, но данные пользователя недоступны';
                    }
                }, 1000);
            } else {
                loaderStatus.textContent = 'Запущено вне Telegram';
            }
        });
    </script>
</body>
</html>
